# 1.29需要添加和修改内容 （继承之前未完成功能）

1-freq 和 ampl 按键以后，按上下是数字加减 --√
3-SCPI添加行以后，前面板添加行的时候，需要向向后移动数据，然后更改当前行内容 --√
4-接收到REMOTE指令以后，需要先跳到主界面  --如果跳到主界面，会导致行添加不上去 先不加这个功能
5-去除自动开机部分代码，更改为接收到后端启动指令后再开机 --√
6-编辑框光标移动到数字最后一位  --√
9-step计算是错误的  --√ （写成使用sweep_ampl_start计算了）
10-RF MODF lable没有改变  --√
11-旋钮的enter被我关闭了   --√


# 1.30
## 前面板
1-开机：界面死机 --加大lvgl空间 √
2-重启之后，RF信号不出现，过一会再出现，开机功率不对，按按键有反应 --连接到PS端开机并添加开机reset函数 --√
3-最大输出功率开关不起作用 --再看看 --√
4-RF MODF lable没有改变  --√
5-step计算是错误的  --√ （写成使用sweep_ampl_start计算了）
6-SCPI远程发送倍频过来，界面没有更改 没添加相关代码 --√
7-POWER MAX 按下之后，聚焦不在textarea上 -- 没写相关代码 √
8-前面板在远控模式下，触摸还可以用，应该屏蔽掉触摸功能  未写移除button触摸点击事件--√
12-local按键连接到前面板，不从后端接收了  --√ 需要测试一下
17-SCPI删除行，一共4行，但是发删除第5行的话会死机，应该屏蔽掉不反应  --√
18-接收的功率显示为100倍数  --√

2-1日已解决
## 前面板
4-列表的添加显示有问题，ps端执行正常 --√
6-sweep更改points之后，step没有更改，需要实时更改 --√
7-step哪里按enter 数值乱跳 --√
9-LIST 的第三页显示不对 --√
11-更改step，要重新计算一下point，然后再返回来计算step --√
13-step先更改成Ghz,然后按points，再按step，显示的单位是Mhz --√
14-未接收到uart_init=1指令就直接开机了 --√ （自动跳转函数没有屏蔽）


2-2日已解决并测试
## 前面板
6-SCPI倍频和OFFSET向前发了，但是计算错误 --√
7-启动特别慢 好像没有接收到fun指令  --√ 应该用else
8-应该所有的textarea1和2的单位，重新赋值后都不对 --√
25-PS端远程第一次连接的时候，开始丢失指令，需要发送两次                          --√ 加延迟到15ms 测试不丢失

## PS端
9-sweep trigger out 和 points 都没有输出信号                               --√ 赋值错误，赋给ext trigger了
12-SCPI sweep trigger out回复是错误                                       --√ 赋值错误，赋给ext trigger了
13-SCPI 驻留时间的查询都是100                                               --√ 赋值错误，赋成step了
18-晶振设置5，前面板显示5000                                                --√ 赋值错误 赋给step了 函数用的freq的type
6-SCPI扫频正反查询返回错误  返回是正常的 再测试一下                             --？？？？ 无问题
20-SCPI发送trigger 的bus等等，前面板没变                                    --？？？？ 变了 无问题
14-SCPI 往前发送pulse的trigger delay 单位不更新且大小没做保护                 --单位不往前发，数值正确
19-SCPI连续发送添加行 前面板死机                                            --？？？？ 无问题
21-第一次远程连接的时候，丢失指令，在发送的时候加延迟                            --√
22-最新程序有问题，经常启动不起来，但是后台也不报错，只要我一更新，就启动不起来了     --√ 从智铭虚拟机拷贝代码，好了

2-4日已解决
## PS端
6-往前发送pulse的trigger delay大小保护                        --√ 已经添加大小保护，不加单位应该有同上问题
8-设置成bus之后没用信号输出                                    --√ 已添加，执行错误 Execution error
9-SCPI的INCR信号没变 缺少执行指令 freq和ampl                    --√ 已添加，测试成功
10-SCPI缺少sweep single 缺少trigger指令                       --√ 已添加，执行错误
11-SWEEP和LIST的ext on 缺少SCPI指令                           --√ 已添加，测试成功

## 前面板
1-前面板接收功率的时候，如果user max开启，则需要进行判断  --√ 待测试
2-列表添加行逻辑和ps端不一致，ps端是当前有一行，可以添加第一行和第二行  --√
    PS端逻辑：1-如果是存在当前行，则当前行开始下移，并更改当前行  2-如果插入行-现在总行，则从插入行-1下移，并更改当前行
3-sweep更改之后，points没加1 --√
4-sweep points和step进行聚焦切换的时候死机  --√
5-删除行的时候聚焦没有上移动    --√
6-删除行的时候聚焦跳到第一行了
7-添加行，然后按下一页的时候，都应该在第一行  --√
8-开机后第二次关机会死机，参数有更改才会死机，不改参数不会死机，更改list一定会死机 --√  还是死机 把文件的面板生成屏蔽就好了？是内存问题吗
    原因：未知
    更改办法：//		lv_textarea_set_placeholder_text(file_obj[2], "255");  屏蔽
            //		lv_textarea_set_placeholder_text(file_obj[3], "255");
            		lv_group_remove_obj(file_obj[2]);                      添加
                    lv_group_remove_obj(file_obj[3]);
9-PS端更改行数和删除行数不对，前面板删除下一页的第一行，后面删除的是倒数第二行，更改数据也一样，看看是不是发送的行数不对 --√


6-功率的dbm按键没有做最大功率开启关闭的判断  --√ 已测试
7-列表的删除还是会丢失聚焦 在delete的时候，点击ampl/freq，然后再点delete就会丢失聚焦，focus计算错误 --√ pulse和flat 已测试
8-接收到数据之后做大小保护   --√ 已测试
9-缺少incr的函数判断  --√ 已测试 应该使用param_no做判断

# 2-6日 已解决
## PS端
1-sweep dewll 没加大小保护                                    --√ 已测试
2-pulse trigger delay 大小保护                               --√ 已测试
3-pulse width解析出来的数值是0 脉宽小于周期的判断错误              --√ 已测试
4-缺少pulse list里面的脉宽和周期大小判断                         --√ 已测试
5-缺少列表里面参数大小判断                                      --√ 已测试

## 前面板
1-脉宽小于周期的判断逻辑添加                                     --√ 已测试
2-列表前面板也加保护判断                                        --√ 已测试
3-缺少pulse list里面的脉宽和周期大小判断，单位也要转换              --√ 已测试

# 2-7日 已解决
1-平坦度给所有的点都做了补偿 --                                 --√ FPGA做的更新
2-Mod On Off 没有信号  --PS端代码页是有写的                     --√ pulse source 的内部和外部不用取反
3-pulse out 没有信号                                         --√ 写错了，使用268地址，用的0x10
3-PRESET-倍频，RF-preset-RF-preset-RF无信号，第三次才出现   (已经发送到FPGA) --√ 发了两次0x10，去掉一次就好了 没有完全好，有时候有，有时候没有
4-开机的时候功率是-7dbm，应该是-10才对                          --√ preset 只要rf关闭和一次频率一次功率，其他指令不要发
5-preset之后，功率下滑 需要和原2U代码做对比                      --√ 同上

# 前面板  -还没更新到github
1-列表功率要初等于10                                --√
2-SWEEP trigger  ext打开的时候，上一页按钮显示的是free --√


2月8日已解决
1-添加远控外部触发label显示 --√
2-按FREQ以后，按上是INCR++， 按下是INCR--√
3-sweep freq_start step stop buf设置，要缩写3个0  --√
4-把辅助界面也都写了，功能可以不写，但是界面得有  --√
5-pulse mode的界面拿到pulse的主界面  --√
6-前面板设置脉宽，后面解析错误，收到的是0？？？，设置周期以后才可以设置脉宽，接收到的数据是对的，但是打印是错误的  --√ 已测试，需要先设置周期再设置脉宽 原因未知
7-开机pulse out打开之后，打开rf没信号，第一次开rf要把周期和脉冲设置给fpga，开机初始化要把参数发下去  --√ 已测试
8-重新设置脉宽和周期以后就有了，preset之后还是有信号，按rf的开关也持续有信号？  -- √ 已测试，地址写错了，trigger极性和pulse极性地址写错
9-开机直接打开pulse out 和rf 直接就有信号，rf为0                  --√ 已测试

1月19日已解决
## PS
1-scpi的trigger的查询，新添加了ext指令，查询的时候应该做互斥     --√ 已测试
2-SCPI设置trigger的时候，要把ext关掉                         --√ 已测试
3-功率极性查询只有up                                         --√ 已测试，返回的是freq_dir，赋值错误
## 前面板
1-辅助界面的具体功能添加                                         --√ 已测试 有的前面板
2-scpi接收最大功率开关，前面板数值没更改                        --√ 已测试
3-scpi发送两次最大功率，前面板数值才更改                        --√ 已测试
4-pulse mode的返回界面错误                                  --√ 已测试
5-sweep freq step 文本超出更改，还有sweep trigger out 超出设置 --√ 已测试
6-INCR没做最大功率开关的大小判断                               --√ 已测试
7-SCPI先前发送trigger 的时候要把ext关掉                       --√ 已测试
8-preset需要把前面板label的int ref 改成ext ref              --√ 已测试
9-scpi 先发功率最大值，然后打开最大功率开关，界面没变            --√ 已测试
10-文件添加面板开机就会死机，重新画一个面板试试                   --lvgl空间不够导致的，现在只能显示1行 √



## PS端
1-pulse 的trigger delay 也是返回out of range                 --有scpi指令 返回out of range
2-SCPI设置pulse里的脉宽和周期设置不了 也查询不了                  --有scpi指令，返回out of range
3-SCPIstop ampl设置不了                                      --有scpi指令，返回Suffix not allowed
4-添加*TRG指令不能用                                          --返回同上
5-第一次发*RST的时候也发送了remote指令 要屏蔽掉

6-进度条功能添加                                             --√ 待测试
7-倍频更改，前面设置1G，倍频设置为2，输出信号为 （1G - offset）/ 倍频，前面板显示1G
8-功率不准                                                    -- preset 只下发rf 功率 频率的话 功率是准的，现在发一堆东西功率会不准，重新设置功率会好，所以加延迟测一下
9-频率设置ICNR为15G，然后按INCR 函数接收到了，但是没有执行

## 2.20日已解决
## 前面板
1-文件列表所有框不可以修改 可能要更改textarea的callback才可以做到
2-进度条功能添加                                            --√ 待和ps联调
3-前面板打开mod on的时候 把alc设置为关闭                      --√ 已测试
4-textarea都设置一下32为长度                                --√ 已测试
5-文件保存文件死机问题，配置错误，或者空间给的不对                --√ 已测试
6-上下按键的加减没有控制上大小判断                             --√ 已测试
7-列表参数添加offset和倍频计算                               --√ 已测试

## 2.21日前面板已解决
## 未完成功能
1-save和recall文件保存加载 --sate 文件，包含删除和改名，f_unlink, f_rename --√ 已测试
2-rtc时间配置和发送                                     --√ 已测试
3-rtc时间设置                                          --√ 已测试
3-单文件加载显示，修改保存功能                             --√ 已测试
## 问题
4-SCPI删除行，要更新一下list_page_num                    --√ 已测试
5-RF MOD_SW没有联动前面的灯                              --√ 已测试
6-list trigger，选了trigger_key, button显示的是错的的，选择的框是free fun --√ 已测试
7-在远控的时候关机再开机，要把灰色界面取消掉                  --√ 已测试
8-LIST里面的Dwell单位一直是us，不能显示ms                  --√ 已测试，拼接单位错误

## 2月23日
1-外部参考的param_no不对，接到脉冲去了，前后都没写，ref source
2-textarea如何设置成不可编辑，不可选中
3-驻留时间大小判断和LIST最小为100us， 最大是100s             --√ 已测试
4-把user_preset按钮连接上                                --√ 已测试
5-进度条测试                                             --√ 已测试
6-RF MOD SW 没卡开启关闭                                 --√ 要取反，1是关闭，0是打开，所以PS发1，要写0

## 2月26日 --已更新到git
* preset进度条没有重置，开关机也没重置                       --√ 已测试
* RF MOD_SW label没有添加                                --√ 已测试
* 倍频大小判断，按一个超大的数，textarea会超出，PS也加，uart接收要再判断一次   --已测试
* 添加ref mode判断，外部参考，preset不重置，只根据从PS端发过来更改           --待测试
* Freq/Ampl上下按钮加减，数据未同步到Freq/Ampl面板上                      --已测试

## 2月28日  --已更新到git
* trigger delay 0-10s                                   --√ 已测试
* MOD_ON 显示ACL_OFF, OFF要打开ALC，Label不显示            --√ 已测试
* 驻留时间：100us - 100s                                  --√ 已测试

## 3月1日  --问题
* PRESET不重置IP                                         --√ 已测试
* RECALL没有恢复save的状态                                 --√ 待测试
* IP没办法设置了                                          --√ 已测试
* 状态栏显示EXT REF后，按PRESET会将EXT状态清除掉为INT         --√ 待测试
* Save Current State状态下，修改文件名后，按ENTER是否应该保存文件？按了ENTER后文件名后没有出现STATE.csv。 按RENAME才是更改，应该屏蔽enter
* Preset后，IP地址、Subnet Mask、Gate和DNS Server会重置。    --√ 已测试
* System 时间状态无法关闭。                                 --√ 已测试

## 3月8日  --问题
* 加载文件 --> preset --> 加载文件 然后数据没有向后发 因为发的list_type不对 --√ 已测试
    PS端默认有一行，所以加载完文件以后，要把PS最后一行删除
    第二次加载文件的时候，删除行要发给PS
* 加载文件的时候，不是在return的时候清除列表，而是应该在加载文件中的时候清除列表